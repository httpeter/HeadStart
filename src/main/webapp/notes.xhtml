<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"      
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns:p="http://primefaces.org/ui">

    <h:head>               
        <ui:include src="included/head.xhtml"/>
        <title>#{labels.appTitle} - #{labels.organizationName}</title>

        <script>
            function onMessage(message, channel, event) {
                console.log('jsf push message::' + message + ", channel ::" + channel + ", event::" + event);
                document.getElementById("messageInput").innerHTML = message;
            }
        </script>    

    </h:head>

    <h:body>

        <h:form>

            <ui:include src="included/menu.xhtml"/>                   

            <p:panel>

                <p:commandButton id="chatButton" value="Chat"/>

                <p:overlayPanel for="chatButton">

                    <h:panelGrid columns="2">
                        <p:outputLabel for="name" value="Name" /> 
                        <p:inputText id="name"/>

                        <p:outputLabel for="msg" value="Message" /> 
                        <p:inputTextarea id="msg" />

                        <h:outputText/>
                        <p:commandButton value="Send" />
                    </h:panelGrid>        

                </p:overlayPanel> 

            </p:panel>


            <p:panel>

                <p:commandButton id="sendMessage" 
                                 action="#{notesController.sendMessage()}" 
                                 value="Send Message" update="messageInput"/>                                    

                <br/>                    
                <p:inputText id="messageInput" value="#{notesController.message}"/>

            </p:panel>

        </h:form>

        <f:websocket channel="helloChannel" onmessage="onMessage" />

    </h:body>

</html>