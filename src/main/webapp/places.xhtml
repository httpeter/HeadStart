<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"      
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns:p="http://primefaces.org/ui">

    <h:head>               
        <ui:include src="included/head.xhtml"/>
        <title>#{labels.appTitle} - #{labels.organizationName}</title>
    </h:head>

    <h:body styleClass="placesPage">



        <h:form>


            <!--MAIN MENU-->
            <ui:include src="included/menu.xhtml"/>        

            <!--DIALOGS-->
            <ui:include src="included/tripEditDLG.xhtml"/>
            <ui:include src="included/placesDLG.xhtml"/>

            <!--WIDGETS ARE IMPLEMENTED USING PF DASBOARD COMPONENT-->
            <p:dashboard model="#{placesController.dashboardModel}">




                <!--TIMELINE-->
                <p:panel id="timeLine" rendered="#{placesController.selectedTripID!=0}">
                    <p:accordionPanel>
                        <p:tab title="Timeline: #{placesController.selectedTrip.name}">
                            <p:timeline id="timeline" 
                                        value="#{placesController.timelineModel}">

                                <p:ajax event="select" 
                                        listener="#{placesController.selectTimeline}"
                                        update="@form"/>

                            </p:timeline>                    
                        </p:tab>
                    </p:accordionPanel>                    
                </p:panel>




                <!--TRIPS-->
                <p:panel id="trips" 
                         style="min-width: 360px;max-width: 1200px;">

                    <p:accordionPanel activeIndex="#{placesController.tabIndex}" >

                        <p:tab title="Trip: #{placesController.selectedTrip.name}">

                            <!--                            <p:gmap id="gmap" 
                                                                widgetVar="gmap" 
                                                                center="52.1601, 4.4970" 
                                                                zoom="14" 
                                                                type="map" 
                                                                style="width:300px;height:300px"/>-->



                            <p:panelGrid columns="2" layout="grid">

                                <h:outputText value="Selected"/>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu value="#{placesController.selectedTripID}" 
                                                     style="width:100%">
                                        <f:selectItem itemLabel="select..." rendered="#{placesController.selectedTripID==0}"/>
                                        <f:selectItems value="#{placesController.trips}" 
                                                       var="trip" 
                                                       itemValue="#{trip.id}" 
                                                       itemLabel="#{trip.name}"/>
                                        <p:ajax update="@form" 
                                                listener="#{placesController.loadPlaces()}"/>                                        
                                    </p:selectOneMenu>
                                    <p:commandButton icon="fa fa-gear"                                                  
                                                     onclick="PF('tripEditDLG').show();" 
                                                     rendered="#{placesController.selectedTripID!=0}"/>                    
                                </h:panelGrid>

                                <h:outputText value="Description"/>
                                <h:outputText value="#{placesController.selectedTrip.description}"/>

                                <h:outputText value="Duration"/>
                                <h:outputText value="#{placesController.selectedTripDuration} days"/>

                                <h:outputText value="Notes"/>
                                <p:inputTextarea value="#{placesController.selectedTrip.notes}"                                         
                                                 style="width:100%; border: none;"
                                                 disabled="true"/>                                                               
                            </p:panelGrid>                                                                          

                        </p:tab>

                        <p:tab title="Selected place: #{placesController.selectedPlace.name}" 
                               rendered="#{placesController.selectedPlace!=null}">

                            <p:panelGrid columns="2" layout="grid" style="min-width: 400px">

                                <h:outputText value="Name" styleClass="headerText"/>
                                <p:inputText value="#{placesController.selectedPlace.name}"/>

                                <h:outputText value="Rating" styleClass="headerText"/>
                                <p:rating value="#{placesController.selectedPlace.rating}" />


                                <h:outputText value="Image URL:" styleClass="headerText"/>
                                <p:inputText  value="#{placesController.selectedPlace.urls}"/>

                                <h:outputText value="Image:" styleClass="headerText"/>
                                <p:graphicImage url="#{placesController.selectedPlace.urls}"
                                                width="165"/>                                                                                                                              


                                <h:outputText value="Description" styleClass="headerText"/>
                                <p:inputTextarea value="#{placesController.selectedPlace.description}"/>                                                                                                     

                                <h:outputText value="Arrival" styleClass="headerText"/>
                                <p:calendar value="#{placesController.selectedPlace.arrivaldate}" 
                                            pattern="dd-MM-yyyy" 
                                            timeZone="CET"/>


                                <h:outputText value="Departure" styleClass="headerText"/>
                                <p:calendar value="#{placesController.selectedPlace.departuredate}" 
                                            pattern="dd-MM-yyyy" 
                                            timeZone="CET"/>

                                <h:outputText value="Total stay" styleClass="headerText"/>
                                <h:outputText value="#{placesController.selectedPlace.departuredate.date - placesController.selectedPlace.arrivaldate.date} days"/>

                                <h:outputText value="Country" styleClass="headerText"/>
                                <p:inputText value="#{placesController.selectedPlace.country}"/>

                                <h:outputText value="Address" styleClass="headerText"/>
                                <p:inputTextarea value="#{placesController.selectedPlace.address}"/>


                            </p:panelGrid>

                        </p:tab>


                    </p:accordionPanel>

                </p:panel>





            </p:dashboard>









            <!--This does not work yet-->
            <p:outputPanel id="adminPanel" 
                           rendered="#{sessionController.currentUser.role=='admin'}"
                           styleClass="myMobileMenuButton">

                <p:commandButton id="addButton" value="Add"/>

                <p:overlayPanel for="addButton">

                    <h:panelGrid columns="2">

                        <p:outputLabel value="Name"/> 
                        <p:inputText id="name"/>

                        <p:outputLabel for="msg" value="Message" /> 
                        <p:inputTextarea id="msg" />

                        <h:outputText/>
                        <p:commandButton value="Send" />

                    </h:panelGrid>        

                </p:overlayPanel> 

            </p:outputPanel>


        </h:form>







    </h:body>

</html>